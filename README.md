## Vulnerability details

In the [ themegrill-demo-importer ](https://wordpress.org/plugins/themegrill-demo-importer/) wordpress plugin  versions 1.3.4 and above and versions 1.6.1 and below, there is a vulnerability that allows any unauthenticated user to reset the entire database to its default state after which they are automatically logged in as an administrator user. 

Once the plugin detects that a ThemeGrill theme is installed and activated, it loads the file /includes/class-demo-importer.php which hooks reset_wizard_actions into admin_init.

The admin_init hook runs not only in the admin environment but also on calls to /wp-admin/admin-ajax.php which does not require an authenticated user.

A [security patch](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2245070%40themegrill-demo-importer%2Ftrunk&old=2190304%40themegrill-demo-importer%2Ftrunk&sfp_email=&sfph_mail=) was release on 16-02-2020 .

if it is not possible for you to update the plugin to a version above 1.6.1, you can use the modsecurity rule that i have provided to secure your website, until founding a way to update the module :)

## Prerequisites

The prerequisite is that there should be a theme installed and activated that was published by ThemeGrill WordPress plugin. In order to be automatically logged in as an administrator, there must be a user called “admin” in the database. Regardless of this condition, the database will still be wiped to its default state.

## Build

- configure the mandatory vars on .env file
- To build the stack: ``` cd build && sudo docker-compose up -d ```
- To destroy the stack without removing volumes: ``` sudo docker-compose down  ```
- To destroy the stack and remove all the related volumes: ``` sudo docker-compose down --volumes ```
- After building the stack you should upload the .zip plugin (https://downloads.wordpress.org/plugin/themegrill-demo-importer.1.6.1.zip) and enable the plugin by installing a ThemeGrill Theme.
- When initiating the website, choose "admin" as administrator login.

